<!doctype html>
<html lang="en">
  <head>
    <title>Task management with org-roam Vol. 3: FILETAGS</title>
    <link rel="stylesheet" href="../css/post-bundle.css" />
    <meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="keywords" content="blog,programming,Haskell,Emacs,fish,bash">
<meta property="og:title" content="Boris Buliga">
<meta property="og:locale" content="es_US">
<meta property="og:url" content="https://d12frosted.io">

<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="manifest" href="../site.webmanifest">

<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
<script>
  MathJax = {
    svg: {
      fontCache: 'global'
    }
  };
</script>
<script type="text/javascript" id="MathJax-script" async src="../library/mathjax/es5/tex-svg.js">
</script>
<script src="../library/chart.js/dist/Chart.min.js"></script>
<script data-goatcounter="https://d12frosted.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>

    <meta name="description" content="Automatic FILETAGS application in org-roam" />
    <meta name="twitter:card" content="summary">
    <meta name="twitter:description" content="Automatic FILETAGS application in org-roam">
    <meta property="og:description" content="Automatic FILETAGS application in org-roam">
  </head>
  <body>
    <header>
      <nav>
  <ul>
    <li><a class="fa fa-home" href="../" title="Home">&nbsp Home</a></li>
    <li><a class="fa fa-suitcase" href="../projects.html" title="Projects">&nbsp Projects</a></li>
    <li><a class="fa fa-rss" href="../atom.xml" title="RSS">&nbsp RSS</a></li>
    <li><a class="fa fa-github" href="https://github.com/d12frosted" title="GitHub profile">&nbsp GitHub</a></li>
  </ul>
</nav>

    </header>

    <h1 class="post-title">Task management with org-roam Vol. 3: FILETAGS</h1>
    <div class="date"><span>June 25, 2020</span></div>
    <div class="tags"><span>(<a title="All pages tagged 'emacs'." href="../tags/emacs.html">emacs</a>, <a title="All pages tagged 'org-roam'." href="../tags/org-roam.html">org-roam</a>, <a title="All pages tagged 'org-mode'." href="../tags/org-mode.html">org-mode</a>)</span></div>
    <article>
      <section>
        <p>In the previous articles (<a href="https://d12frosted.io/posts/2020-06-23-task-management-with-roam-vol1.html">vol1</a> and <a href="https://d12frosted.io/posts/2020-06-24-task-management-with-roam-vol2.html">vol2</a>) we walked the path to <a href="https://github.com/org-roam/org-roam">org-roam</a> and solved the issue with garbage in the category column of agenda. Today we are going to explore meta projects dedicated to specific person, tag inheritance and moving such projects to separate <code class="verbatim">org-roam</code> files. As result, we will have code for automatic tagging based on the title.</p>
<p>Aside from regular meta projects (like personal blog) I also create meta projects for people and locations. This is helpful, because some of the tasks are really related to someone specifically. For example, when I need to return a borrowed book, I just create a task for this.</p>
<pre class="org"><code>* Frodo Baggins                                               :@FrodoBaggins:

** TODO Return 'The Lord of the Rings' book

** TODO Farewell party                                             :PROJECT:

It feels like Mr. Frodo is about to live Shire. So we are going to setup a
farewell party for him.

*** TODO Talk to Samwise Gamgee                            :@SamwiseGamgee:

*** TODO Talk to Meriadoc Brandybuck                  :@MeriadocBrandybuck:

*** TODO Talk to Peregrin Took                              :@PeregrinTook:

*** TODO Tie a pair of wool socks

I am not sure where he is going, so a pair of warm wool socks should be good.
At least they can be used to protect bottles of wine during journey. That is in
case Frodo doesn't wear socks. But how could it be? Everyone does!
</code></pre>
<p><strong>Change Log:</strong></p>
<ul>
<li><code>[2021-01-24 Sun]</code>: Since some of the functionality mentioned in the original article was merged to <code class="verbatim">org-roam</code>, all code is updated to reflect the current state of affairs.</li>
<li><code>[2021-03-02 Tue]</code>: Update naming convention to match <a href="https://github.com/d12frosted/environment/tree/master/emacs">personal configurations</a>.</li>
<li><code>[2021-05-10 Mon]</code>: Update post to reflect changes in <a href="https://github.com/org-roam/org-roam/pull/1401">org-roam v2</a>. Previous version of this article is available on <a href="https://github.com/d12frosted/d12frosted.io/blob/c16870cab6ebbaafdf73c7c3589abbd27c20ac52/posts/2020-06-25-task-management-with-roam-vol3.org">GitHub</a>.</li>
</ul>
<!--more-->

<p>Now, apart from some misconception about hobbits, there are few important points to note.</p>
<ol>
<li>Due to <a href="https://orgmode.org/manual/Tag-Inheritance.html">tags inheritance</a>, all of the subheadings of <code class="verbatim">Frodo Baggins</code> have <code class="verbatim">@FrodoBaggins</code> tag.</li>
<li>Tasks tagged with other people also have the <code class="verbatim">@FrodoBaggins</code> tag.</li>
</ol>
<p>Thanks to inheritance, itâ€™s easy to find all tasks related to Frodo Baggins via <code class="verbatim">org-agenda</code>. It even enables the search of overlapping tasks. For example, tasks related to Frodo and Samwise. For more information, take a look at the <a href="https://orgmode.org/manual/Matching-tags-and-properties.html#Matching-tags-and-properties">matching tags and properties</a> section of the manual.</p>
<div class="post-image post-image-split">
<img src="../images/org-roam-task-management-vol3-1.png" /><img src="../images/org-roam-task-management-vol3-2.png" />
</div>

<p>With <code class="verbatim">org-roam</code>, each person has its own file.</p>
<pre class="org"><code>#+title: Frodo Baggins
#+filetags: @FrodoBaggins people

* Tasks
** TODO Return 'The Lord of the Rings' book

** TODO Farewell party                                             :PROJECT:

It feels like Mr. Frodo is about to live Shire. So we are going to setup a
farewell party for him.

*** TODO Talk to Samwise Gamgee                            :@SamwiseGamgee:

*** TODO Talk to Meriadoc Brandybuck                  :@MeriadocBrandybuck:

*** TODO Talk to Peregrin Took                              :@PeregrinTook:

*** TODO Tie a pair of wool socks

I am not sure where he is going, so a pair of warm wool socks should be good.
At least they can be used to protect bottles of wine during journey. That is in
case Frodo doesn't wear socks. But how could it be? Everyone does!
</code></pre>
<p>In order to maintain the feature where <code class="verbatim">@FrodoBaggins</code> tag is applied to all TODO items we have to use <code class="verbatim">filetags</code> property. I am also using id to mark Frodo Baggins as a person (even though he is a hobbit!). This helps me in two ways. First of all, it gives me clear understanding that this entity is a person (some people do have strange names). Secondly, it serves me in automation and filtering (as example, checkout <a href="https://d12frosted.io/posts/2021-01-24-task-management-with-roam-vol6.html">Select a person and view related tasks</a> post).</p>
<p>Now, when I see a headline with title and tag being literally the same (with few programmable exceptions) or the file with <code class="verbatim">title</code> and <code class="verbatim">filetags</code> being the same (with few programmable exceptions), I am feeling nervous. Especially since I am prone to mistakes.</p>
<p>So what I do - I automate <code class="verbatim">filetags</code>. I have a function <code class="verbatim">vulpea-ensure-filetag</code> which automatically sets the <code class="verbatim">filetags</code> buffer property for <code class="verbatim">org-roam</code> entries tagged as <code class="verbatim">people</code>. It uses <a href="https://github.com/d12frosted/vulpea/blob/feature/org-roam-v2/vulpea.el#L183">vulpea-buffer-tags-get</a> and <a href="https://github.com/d12frosted/vulpea/blob/feature/org-roam-v2/vulpea.el#L193">vulpea-buffer-tags-add</a> from <a href="https://github.com/d12frosted/vulpea">vulpea</a> library.</p>
<div class="sourceCode" id="cb3" data-org-language="emacs-lisp"><pre class="sourceCode commonlisp"><code class="sourceCode commonlisp"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">defun</span><span class="fu"> vulpea-ensure-filetag </span>()</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Add respective file tag if it's missing in the current note.&quot;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  (interactive)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">let</span> ((tags (vulpea-buffer-tags-get))</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>        (tag (vulpea--title-as-tag)))</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    (<span class="kw">when</span> (<span class="kw">and</span> (seq-contains-p tags <span class="st">&quot;people&quot;</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>               (<span class="kw">not</span> (seq-contains-p tags tag)))</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>      (vulpea-buffer-tags-add tag))))</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>(<span class="kw">defun</span><span class="fu"> vulpea--title-to-tag </span>(title)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Convert TITLE to tag.&quot;</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  (concat <span class="st">&quot;@&quot;</span> (s-replace <span class="st">&quot; &quot;</span> <span class="st">&quot;&quot;</span> title)))</span></code></pre></div>
<p>This function can be called interactively, but since I usually place the tag using <code class="verbatim">vulpea-tags-add</code>, I just add the <code class="verbatim">vulpea-ensure-filetag</code> to the end of that function.</p>
<div class="sourceCode" id="cb4" data-org-language="emacs-lisp"><pre class="sourceCode commonlisp"><code class="sourceCode commonlisp"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">defun</span><span class="fu"> vulpea-tags-add </span>()</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Add a tag to current note.&quot;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  (interactive)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">;; since https://github.com/org-roam/org-roam/pull/1515</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">;; `org-roam-tag-add' returns added tag, we could avoid reading tags</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">;; in `vulpea-ensure-filetag', but this way it can be used in</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">;; different contexts while having simple implementation.</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">when</span> (call-interactively #'org-roam-tag-add)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    (vulpea-ensure-filetag)))</span></code></pre></div>
<p>Though for other purposes one can put this function to the file visit hook. But hooks are sensitive, so I am going to stop here.</p>
<p>In the <a href="https://d12frosted.io/posts/2020-07-07-task-management-with-roam-vol4.html">next article</a> we are going to talk about automatic insertion of person tag (e.g. <code class="verbatim">@FrodoBaggins</code>) when mentioning this person in other task.</p>
<h1 id="task-management-with-org-roam-series">Task Management with org-roam Series</h1>
<ol>
<li><a href="http://localhost:8000/posts/2020-06-23-task-management-with-roam-vol1.html">Path to Roam</a></li>
<li><a href="https://d12frosted.io/posts/2020-06-24-task-management-with-roam-vol2.html">Categories</a></li>
<li><a href="https://d12frosted.io/posts/2020-06-25-task-management-with-roam-vol3.html">FILETAGS</a></li>
<li><a href="https://d12frosted.io/posts/2020-07-07-task-management-with-roam-vol4.html">Automatic tagging</a></li>
<li><a href="https://d12frosted.io/posts/2021-01-16-task-management-with-roam-vol5.html">Dynamic and fast agenda</a></li>
<li><a href="https://d12frosted.io/posts/2021-01-24-task-management-with-roam-vol6.html">Select a person and view related tasks</a></li>
<li><a href="https://d12frosted.io/posts/2021-05-21-task-management-with-roam-vol7.html">Capture</a></li>
</ol>
<h1 id="references">References</h1>
<ul>
<li><code class="verbatim">org-roam</code> documentation on <a href="https://github.com/org-roam/org-roam">GitHub</a>.</li>
<li><code class="verbatim">org-mode</code> documentation on the <a href="https://orgmode.org">official site</a>.</li>
<li>Org-roam tags on <a href="https://d12frosted.io/posts/2020-06-10-org-roam-tags.html">d12frosted.io</a>.</li>
<li>personal configurations on <a href="https://github.com/d12frosted/environment/blob/master/emacs/lisp/%2Borg-notes.el">GitHub</a>.</li>
</ul>
      </section>
    </article>

    <div class="footer-separator"></div>
    <div class="footer">
      <a target="_blank" class="post-footer-sources" href="https://github.com/d12frosted/d12frosted.io/blob/master/posts/2020-06-25-task-management-with-roam-vol3.org">Sources <i class="fa fa-code fa-lg"></i></a>
    </div>
    <script src="https://utteranc.es/client.js" repo="d12frosted/d12frosted.io" issue-term="pathname" label="comments" theme="github-light" crossorigin="anonymous" async>
    </script>

    <footer>
  <div>
      <p>
        Follow me on <a class="fa fa-github" href="https://github.com/d12frosted" title="GitHub profile">&nbsp GitHub</a>
      </p>
  </div>
</footer>

  </body>
</html>
